<!DOCTYPE html>
<html>
<head>
    <style>
        /* Set font family and background color */
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
        }
    /* Center the header */
    h1 {
        text-align: center;
        margin-top: 50px;
        margin-bottom: 50px;
    }

    /* Set the size and position of the map and table containers */
    #map, #table {
        height: 500px;
        width: 50%;
        float: left;
    }

    /* Set styles for the table */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th, td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #f2f2f2;
    }

    /* Highlight table row on hover */
    .table-row:hover {
        background-color: #e5e5e5;
        cursor: pointer;
    }

    /* Hide columns for lat and lon values */
    .hidden {
        display: none;
    }
</style>

</head>
<body>
    <h1>Data Display</h1>
    <div id="map"></div>
    <div id="table">
        <table>
            <thead>
                <tr>
                    <th>Address</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Postal Code</th>
                    <th>Price</th>
                    <th>Bedrooms</th>
                    <th>Sqft</th>
                    <th>Bathrooms</th>
                    <th class="hidden">lon</th>
                    <th class="hidden">lat</th>
               </tr>
            </thead>
            {% for item in data %}
            <tr class="table-row" data-lat="{{ item.9 }}" data-lon="{{ item.8 }}">
                <td>{{ item.0 }}</td>
                <td>{{ item.1 }}</td>
                <td>{{ item.2 }}</td>
                <td>{{ item.3 }}</td>
                <td>{{ item.4 }}</td>
                <td>{{ item.5 }}</td>
                <td>{{ item.6 }}</td>
                <td>{{ item.7 }}</td>
                <td class="hidden">{{ item.8 }}</td>
                <td class="hidden">{{ item.9 }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key={{api_key}}&callback=initMap"></script>
    <script>
        function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 10,
                center: {lat: 41.9198, lng: -88.0817}
            });

            var markers = [];

            // Loop over all the rows in the table
            var rows = document.querySelectorAll('.table-row');
            for (var i = 0; i < rows.length; i++) {
                var row = rows[i];

                // Create a marker for this row's location
                var lat = row.getAttribute('data-lat');
                var lng = row.getAttribute('data-lon');
                var marker = new google.maps.Marker({
                    position: {lat: parseFloat(lat), lng: parseFloat(lng)},
                    map: map
                });
                markers.push(marker);

                // Add event listeners to the row
                row.addEventListener('mouseover', function() {
                    var index = Array.from(rows).indexOf(this);
                    markers[index].setAnimation(google.maps.Animation.BOUNCE);
                });

                row.addEventListener('mouseout', function() {
                    var index = Array.from(rows).indexOf(this);
                    markers[index].setAnimation(null);
                });
            }
        }

    </script>
